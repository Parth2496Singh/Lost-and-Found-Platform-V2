{% extends "base.html" %}
{% block content %}

<div class="hero-section" style="height:auto; padding:60px 20px; text-align:center;">
    <h1 style="font-size:3rem; color:#00fff7; margin-bottom:1rem;">Report a Lost Item</h1>
    <p style="font-size:1.2rem; color:#fff; opacity:0.9;">Fill in the details below to report your lost item.</p>
</div>

<div class="container d-flex justify-content-center mb-5">
    <div class="form-card">
        <form id="report-lost-form">
            <div class="mb-3">
                <label for="name" class="form-label">Item Name</label>
                <input type="text" id="name" placeholder="Enter item name" required>
            </div>

            <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select id="category" required>
                    <option value="Phone">Phone</option>
                    <option value="Wallet">Wallet</option>
                    <option value="Bag">Bag</option>
                    <option value="Laptop">Laptop</option>
                    <option value="Keys">Keys</option>
                    <option value="Other" selected>Other</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="date_lost" class="form-label">Date Lost</label>
                <input type="date" id="date_lost" required>
            </div>

            <div class="mb-3">
                <label for="location" class="form-label">Location</label>
                <input type="text" id="location" placeholder="Enter location where item was lost" required>
            </div>

            <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea id="description" rows="4" placeholder="Provide details about the item" required></textarea>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn hero-btn">Submit Report</button>
            </div>
        </form>
    </div>
</div>

<script>
const accessToken = localStorage.getItem("access_token");
if(!accessToken){
    alert("Please login to report an item.");
    window.location.href = "{% url 'login' %}?next={% url 'report_lost' %}";
}

document.getElementById("report-lost-form").addEventListener("submit", function(e){
    e.preventDefault();

    const data = {
        name: document.getElementById("name").value,
        category: document.getElementById("category").value,
        date_lost: document.getElementById("date_lost").value,
        location: document.getElementById("location").value,
        description: document.getElementById("description").value
    };

    fetch("/api/lost-items/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + accessToken
        },
        body: JSON.stringify(data)
    })
    .then(res => {
        if(!res.ok) throw new Error("Failed to submit report");
        return res.json();
    })
    .then(result => {
        alert("Lost item reported successfully!");
        window.location.href = "{% url 'dashboard' %}";
    })
    .catch(err => {
        alert("Error sending report. Check console.");
        console.error(err);
    });
});
</script>

<style>
.form-card {
    max-width: 600px;
    width: 100%;
    padding: 2rem;
    background: rgba(255,255,255,0.05);
    box-shadow: 0 15px 40px rgba(0,255,247,0.3);
    border-radius: 20px;
}
.form-card .form-label {
    color: #00fff7;
    font-weight: 600;
}
.form-card input, .form-card select, .form-card textarea {
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
    border-radius: 10px;
    border: 1px solid #00fff7;
    background: rgba(0,0,0,0.5);
    color: #fff;
}
.form-card input::placeholder,
.form-card textarea::placeholder {
    color: #ccc;
}
</style>

{% endblock %}
